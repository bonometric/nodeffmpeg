(function(e){function t(t){for(var r,i,c=t[0],s=t[1],u=t[2],d=0,f=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(f.length)f.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},a={app:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"02bc":function(e,t,n){},2638:function(e,t,n){"use strict";n("02bc")},4110:function(e,t,n){"use strict";n("634f")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function a(e,t,n,a,o,i){var c=Object(r["u"])("Settings");return Object(r["o"])(),Object(r["f"])(c)}n("fb6a");var o=Object(r["E"])("data-v-522eacf4");Object(r["q"])("data-v-522eacf4");var i=Object(r["j"])("h1",null,"Camera Stream Configurations",-1),c={class:"table-header"},s={class:"stream-count"},u=Object(r["i"])(" Total streams: "),l={class:"row-buttons"},d={class:"content"},f={class:"p-field"},p=Object(r["j"])("label",{for:"alias"},"Stream Alias",-1),b={class:"p-field"},m=Object(r["j"])("label",{for:"feed"},"Rtsp Feed",-1),v={class:"processingStatus"},j=Object(r["i"])(" Processing... "),h={class:"buttons"};Object(r["p"])();var O=o((function(e,t,n,a,O,S){var g=Object(r["u"])("Badge"),w=Object(r["u"])("Button"),y=Object(r["u"])("Column"),R=Object(r["u"])("badge"),k=Object(r["u"])("font-awesome-icon"),x=Object(r["u"])("ProgressSpinner"),D=Object(r["u"])("DataTable"),T=Object(r["u"])("Toast"),E=Object(r["u"])("InputText"),U=Object(r["u"])("Dialog"),C=Object(r["u"])("hls-video"),_=Object(r["u"])("ConfirmPopup");return Object(r["o"])(),Object(r["f"])("div",null,[i,Object(r["j"])("div",c,[Object(r["j"])("div",s,[u,Object(r["j"])(g,{value:O.streams.length},null,8,["value"])]),Object(r["j"])(w,{icon:"pi pi-plus",onClick:t[1]||(t[1]=function(e){return S.addNewStream()}),label:"Add new"})]),Object(r["j"])(D,{value:O.streams},{default:o((function(){return[Object(r["j"])(y,{style:{width:"40px"},field:"alias",header:""},{body:o((function(e){return[Object(r["i"])(Object(r["x"])(e.index+1),1)]})),_:1}),Object(r["j"])(y,{field:"alias",header:"Camera Alias"},{body:o((function(e){return[Object(r["j"])("div",{class:"alias",onClick:function(t){return S.viewStream(e.data)}},Object(r["x"])(e.data.alias.charAt(0).toUpperCase()+e.data.alias.slice(1)),9,["onClick"])]})),_:1}),Object(r["j"])(y,{field:"streamUri",header:"Stream URI"}),Object(r["j"])(y,{field:"running",header:"Running Status"},{body:o((function(e){return[Object(r["j"])(R,{value:S.getBadgeValueAndSeverity(e.data).value,severity:S.getBadgeValueAndSeverity(e.data).severity},null,8,["value","severity"])]})),_:1}),Object(r["j"])(y,{field:"action",header:"Actions"},{body:o((function(e){return[Object(r["j"])("div",l,[Object(r["j"])(w,{icon:"pi",class:"p-button-secondary p-button-rounded p-button-outlined",disabled:null===e.data.running,onClick:function(t){return S.removeStream(e.data,t)}},{default:o((function(){return[Object(r["j"])(k,{icon:"trash"})]})),_:2},1032,["disabled","onClick"]),Object(r["j"])(w,{icon:"pi",class:"p-button-rounded p-button-secondary p-button-outlined",onClick:function(t){return S.viewStream(e.data)},disabled:null===e.data.running},{default:o((function(){return[null===e.data.running?(Object(r["o"])(),Object(r["f"])(x,{key:0})):(Object(r["o"])(),Object(r["f"])(k,{key:1,icon:"eye"}))]})),_:2},1032,["onClick","disabled"]),e.data.running?(Object(r["o"])(),Object(r["f"])(w,{key:0,icon:"pi",class:"p-button-rounded p-button-secondary p-button-outlined",disabled:null===e.data.running,onClick:function(t){return S.stopStream(e.data)}},{default:o((function(){return[Object(r["j"])(k,{icon:"stop"})]})),_:2},1032,["disabled","onClick"])):Object(r["g"])("",!0)])]})),_:1})]})),_:1},8,["value"]),Object(r["j"])(T,{position:"top-center"}),Object(r["j"])(U,{class:"dialog new-stream",header:"Add New Stream",visible:O.newStreamDisplayModal,"onUpdate:visible":t[5]||(t[5]=function(e){return O.newStreamDisplayModal=e}),modal:!0,closeOnEscape:!0},{footer:o((function(){return[Object(r["B"])(Object(r["j"])("div",v,[Object(r["j"])(x),j],512),[[r["z"],O.newStreamProcessing]]),Object(r["j"])("div",h,[Object(r["j"])(w,{disabled:O.newStreamProcessing||""==O.newStreamData.alias||""==O.newStreamData.rtspUri,label:"Submit",autofocus:"",onClick:t[4]||(t[4]=function(e){return S.createStream()})},null,8,["disabled"])])]})),default:o((function(){return[Object(r["j"])("div",d,[Object(r["j"])("div",f,[p,Object(r["j"])(E,{id:"alias",modelValue:O.newStreamData.alias,"onUpdate:modelValue":t[2]||(t[2]=function(e){return O.newStreamData.alias=e}),placeholder:"Garage, Room, etc."},null,8,["modelValue"])]),Object(r["j"])("div",b,[m,Object(r["j"])(E,{id:"feed",modelValue:O.newStreamData.rtspUri,"onUpdate:modelValue":t[3]||(t[3]=function(e){return O.newStreamData.rtspUri=e}),placeholder:"rtsp://user:pass@192.168.0.150"},null,8,["modelValue"])])])]})),_:1},8,["visible"]),Object(r["j"])(U,{class:"dialog view-stream",visible:O.streamViewerDisplayModal,"onUpdate:visible":t[8]||(t[8]=function(e){return O.streamViewerDisplayModal=e}),modal:!0,closeOnEscape:!0,onHide:t[9]||(t[9]=function(e){return S.refreshStreamList()})},{header:o((function(){return[Object(r["j"])("h3",null,Object(r["x"])(O.activeVideoAlias),1),Object(r["j"])(w,{icon:"pi",class:"p-button-secondary p-button-rounded p-button-outlined",onClick:t[6]||(t[6]=function(e){return S.restartStream()})},{default:o((function(){return[Object(r["j"])(k,{icon:"sync"})]})),_:1})]})),default:o((function(){return[Object(r["j"])(C,{onIosExitFullscreen:t[7]||(t[7]=function(e){return O.streamViewerDisplayModal=!1}),ref:"videoStream","video-src":O.activeVideoSrc},null,8,["video-src"])]})),_:1},8,["visible"]),Object(r["j"])(_)])})),S=n("1da1"),g=(n("d3b7"),n("96cf"),"orrys-r1.local"),w="8000",y="3030",R={name:"Settings",computed:function(){},data:function(){return{getListURI:"http://"+g+":"+w+"/list",stopURI:"http://"+g+":"+w+"/stop",startURI:"http://"+g+":"+w+"/start",streamUri:"http://"+g+":"+w,newStreamDisplayModal:!1,streamViewerDisplayModal:!1,streams:[],newStreamData:{alias:"foo",rtspUri:"bar"},newStreamProcessing:!1,activeVideoSrc:null,activeVideoAlias:null,listRefreshInterval:-1}},methods:{test:function(e){console.log(e)},restartStream:function(){this.$refs.videoStream.restartStream()},getBadgeValueAndSeverity:function(e){return!0===e.running?{value:"Running",severity:"success"}:!1===e.running?{value:"Stopped",severity:"danger"}:null===e.running?{value:"Starting",severity:"warning"}:void 0},refreshStreamList:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=4;break}t.streams=e,n.next=7;break;case 4:return n.next=6,t.getStreams();case 6:t.streams=n.sent;case 7:t.streams.sort((function(e,t){return e.created>t.created?1:-1}));case 8:case"end":return n.stop()}}),n)})))()},stopStream:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,fetch(t.stopURI,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({alias:e.alias,remove:!1})});case 2:r=n.sent,r.ok?t.refreshStreamList():t.$toast.add({severity:"error",summary:"Stream stop failed",detail:"Stream for '"+e.alias+"' can't be stopped. Reason: "+r.statusText,life:3e3});case 4:case"end":return n.stop()}}),n)})))()},createStream:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.newStreamProcessing=!0,t.next=3,fetch(e.startURI,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rtspUri:e.newStreamData.rtspUri,alias:e.newStreamData.alias})});case 3:n=t.sent,n.ok?e.refreshStreamList():e.$toast.add({severity:"error",summary:"Stream creation failed",detail:"Stream for URI of '"+e.newStreamData.rtspUri+"' can't be created. Reason: "+n.statusText,life:3e3}),e.newStreamDisplayModal=!1,e.newStreamProcessing=!1;case 7:case"end":return t.stop()}}),t)})))()},addNewStream:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.newStreamData.alias="",e.newStreamData.rtspUri="",e.newStreamDisplayModal=!0;case 3:case"end":return t.stop()}}),t)})))()},getStreams:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e.getListURI);case 2:return n=t.sent,t.abrupt("return",n.json());case 4:case"end":return t.stop()}}),t)})))()},removeStream:function(e,t){var n=this;return Object(S["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n.$confirm.require({target:t.currentTarget,message:"Stop and remove stream?",accept:function(){a()},reject:function(){}}),a=function(){var t=Object(S["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.alias,t.next=3,fetch(n.stopURI,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({alias:r,remove:!0})});case 3:a=t.sent,a.ok?n.refreshStreamList():n.$toast.add({severity:"error",summary:"Stream removal failed",detail:"Stream with alias of '"+r+"' can't be removed. Reason: "+a,life:3e3});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();case 2:case"end":return r.stop()}}),r)})))()},viewStream:function(e){var t=this;return Object(S["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.running){n.next=7;break}t.streamViewerDisplayModal=!0,t.activeVideoAlias=e.alias,r=t.streamUri+"/"+e.streamUri,t.activeVideoSrc=r,n.next=11;break;case 7:return n.next=9,fetch(t.startURI,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({alias:e.alias})});case 9:a=n.sent,a.ok&&(e.running=!0,t.viewStream(e));case 11:case"end":return n.stop()}}),n)})))()},connectToWebSocket:function(){var e=this,t=-1;this.connection=new WebSocket("ws://"+g+":"+y),this.connection.onmessage=function(t){var n=JSON.parse(t.data);"stream-update"==n.type&&e.refreshStreamList(n.data)},this.connection.onopen=function(e){console.log(e),console.log("Successfully connected to the echo websocket server...")},this.connection.onclose=function(n){t=setInterval((function(){clearInterval(t),e.connectToWebSocket()}),300)}}},mounted:function(){var e=this;return Object(S["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.refreshStreamList();case 1:case"end":return t.stop()}}),t)})))()},created:function(){this.connectToWebSocket()}};n("b0fb"),n("a612");R.render=O,R.__scopeId="data-v-522eacf4";var k=R,x={name:"App",components:{Settings:k}};n("4110");x.render=a;var D=x,T=n("9319"),E=n("8398"),U=n("bb57"),C=n("5b2c"),_=n("6f85"),P=n("b3b6"),I=n("5bd2"),V=n("9421"),A=n("a469"),M=n("4b7b"),L=Object(r["E"])("data-v-e296c6b8");Object(r["q"])("data-v-e296c6b8");var B={class:"component"},N={autoplay:"",muted:"",controls:"",ref:"videoElement"};Object(r["p"])();var J=L((function(e,t,n,a,o,i){return Object(r["o"])(),Object(r["f"])("div",B,[Object(r["j"])("video",N,null,512)])})),$=n("ba56"),W=n.n($),H={props:{videoSrc:String},methods:{startStream:function(){var e=this;this.hls&&this.hls.destroy();var t=this.$refs.videoElement;if(t.addEventListener("webkitendfullscreen",(function(t){e.$emit("ios-exit-fullscreen"),console.log("emit exit event")})),t.canPlayType("application/vnd.apple.mpegurl"))t.src=this.videoSrc,t.play();else if(W.a.isSupported()){var n={enableWorker:!0,liveDurationInfinity:!0};this.hls=new W.a(n),this.hls.attachMedia(t),this.hls.on(W.a.Events.MEDIA_ATTACHED,(function(){e.hls.loadSource(e.videoSrc),e.hls.on(W.a.Events.MANIFEST_PARSED,(function(){console.log("parsed"),console.log(e.hls),t.play(),setTimeout((function(){e.videoSize.w=t.getBoundingClientRect().width,e.videoSize.h=t.getBoundingClientRect().height}),500)}))})),this.hls.on(W.a.Events.ERROR,(function(t,n){if(console.log("HLS Error: ",n),n.fatal)switch(n.type){case W.a.ErrorTypes.NETWORK_ERROR:console.log("fatal network error encountered, try to recover"),e.restartStream();break;case W.a.ErrorTypes.MEDIA_ERROR:console.log("fatal media error encountered, try to recover"),e.restartStream();break;default:console.log("HLS cannot recover, destroying"),e.hls.destroy();break}})),t.addEventListener("ended",(function(e){console.log("ended")})),t.addEventListener("abort",(function(e){console.log("abort")})),t.addEventListener("emptied",(function(e){console.log("emptied")})),t.addEventListener("waiting",(function(e){console.log("waiting")}))}},restartStream:function(){this.startStream()}},computed:{},data:function(){return{hls:null,videoSize:{w:0,h:0}}},unmounted:function(){this.hls&&this.hls.destroy()},mounted:function(){this.startStream()}};n("2638");H.render=J,H.__scopeId="data-v-e296c6b8";var z=H,q=n("ecee"),F=n("c074"),G=n("ad3d"),K=n("b24b"),Q=n("485c");n("fa3d"),n("e1ae"),n("4121");q["c"].add(F["c"],F["b"],F["e"],F["a"],F["d"]);var X=Object(r["e"])(D);X.use(T["a"]),X.use(Q["a"]),X.use(K["a"]),X.component("font-awesome-icon",G["a"]),X.component("HlsVideo",z),X.component("Badge",M["a"]),X.component("ProgressSpinner",A["a"]),X.component("ConfirmPopup",V["a"]),X.component("InputText",E["a"]),X.component("Button",U["a"]),X.component("DataTable",C["a"]),X.component("Column",_["a"]),X.component("Toast",P["a"]),X.component("Dialog",I["a"]),X.mount("#app")},"634f":function(e,t,n){},"8b72":function(e,t,n){},a612:function(e,t,n){"use strict";n("8b72")},b0fb:function(e,t,n){"use strict";n("f033")},f033:function(e,t,n){}});
//# sourceMappingURL=app.9425b60f.js.map